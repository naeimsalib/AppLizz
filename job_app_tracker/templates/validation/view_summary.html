{% extends "base.html" %} {% block title %}Validation Summary{% endblock %} {%
block content %}
<div class="container mt-4">
  <h1>Validation Summary</h1>
  <p class="lead">{{ summary_file }}</p>

  <div class="mb-3">
    <a
      href="{{ url_for('validation.email_validation') }}"
      class="btn btn-secondary"
    >
      <i class="fas fa-arrow-left"></i> Back to Dashboard
    </a>
  </div>

  <div class="row mb-4">
    <div class="col-lg-12">
      <div class="card">
        <div class="card-header">
          <h5>Session Information</h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-4">
              <strong>Session ID:</strong> {{ summary_data.session_id }}
            </div>
            <div class="col-md-4">
              <strong>Start Time:</strong> {{ summary_data.start_time }}
            </div>
            <div class="col-md-4">
              <strong>End Time:</strong> {{ summary_data.end_time }}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="row mb-4">
    <div class="col-lg-6">
      <div class="card">
        <div class="card-header">
          <h5>Email Statistics</h5>
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-bordered">
              <tbody>
                <tr>
                  <th>Total Emails</th>
                  <td>{{ summary_data.total_emails }}</td>
                </tr>
                <tr>
                  <th>Processed Emails</th>
                  <td>{{ summary_data.processed_emails }}</td>
                </tr>
                <tr>
                  <th>Job-Related Emails</th>
                  <td>{{ summary_data.job_related_emails }}</td>
                </tr>
                <tr>
                  <th>Correctly Processed</th>
                  <td>{{ summary_data.correctly_processed }}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <div class="col-lg-6">
      <div class="card">
        <div class="card-header">
          <h5>Error Statistics</h5>
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-bordered">
              <tbody>
                <tr>
                  <th>Total Errors</th>
                  <td>{{ summary_data.errors.total }}</td>
                </tr>
                <tr>
                  <th>Classification Errors</th>
                  <td>{{ summary_data.errors.classification }}</td>
                </tr>
                <tr>
                  <th>Status Errors</th>
                  <td>{{ summary_data.errors.status }}</td>
                </tr>
                <tr>
                  <th>Company Errors</th>
                  <td>{{ summary_data.errors.company }}</td>
                </tr>
                <tr>
                  <th>Position Errors</th>
                  <td>{{ summary_data.errors.position }}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  {% if summary_data.accuracy %}
  <div class="row mb-4">
    <div class="col-lg-12">
      <div class="card">
        <div class="card-header">
          <h5>Accuracy Metrics</h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-3">
              <div class="card mb-3">
                <div class="card-header">Overall</div>
                <div class="card-body">
                  <h5 class="card-title">
                    {{ (summary_data.accuracy.overall * 100)|round(1) }}%
                  </h5>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="card mb-3">
                <div class="card-header">Classification</div>
                <div class="card-body">
                  <h5 class="card-title">
                    {{ (summary_data.accuracy.classification * 100)|round(1) }}%
                  </h5>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="card mb-3">
                <div class="card-header">Status</div>
                <div class="card-body">
                  <h5 class="card-title">
                    {{ (summary_data.accuracy.status * 100)|round(1) }}%
                  </h5>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="card mb-3">
                <div class="card-header">Company</div>
                <div class="card-body">
                  <h5 class="card-title">
                    {{ (summary_data.accuracy.company * 100)|round(1) }}%
                  </h5>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="card mb-3">
                <div class="card-header">Position</div>
                <div class="card-body">
                  <h5 class="card-title">
                    {{ (summary_data.accuracy.position * 100)|round(1) }}%
                  </h5>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  {% endif %} {% if summary_data.status_distribution %}
  <div class="row mb-4">
    <div class="col-lg-12">
      <div class="card">
        <div class="card-header">
          <h5>Status Distribution</h5>
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>Status</th>
                  <th>Count</th>
                </tr>
              </thead>
              <tbody>
                {% for status, count in summary_data.status_distribution.items()
                %}
                <tr>
                  <td>{{ status }}</td>
                  <td>{{ count }}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
  {% endif %} {% if summary_data.improvement_suggestions %}
  <div class="row mb-4">
    <div class="col-lg-12">
      <div class="card">
        <div class="card-header">
          <h5>Improvement Suggestions</h5>
        </div>
        <div class="card-body">
          <div class="list-group">
            {% for suggestion in summary_data.improvement_suggestions %}
            <div class="list-group-item">
              <div class="d-flex w-100 justify-content-between">
                <h5 class="mb-1">{{ suggestion.type }}</h5>
                {% if suggestion.priority %}
                <small class="text-muted"
                  >Priority: {{ suggestion.priority }}</small
                >
                {% endif %}
              </div>
              <p class="mb-1">{{ suggestion.description }}</p>
              <small class="text-muted"
                >Suggestion: {{ suggestion.suggestion }}</small
              >
            </div>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>
  </div>
  {% endif %}

  <div class="mb-3">
    <a
      href="{{ url_for('validation.email_validation') }}"
      class="btn btn-secondary"
    >
      <i class="fas fa-arrow-left"></i> Back to Dashboard
    </a>
  </div>
</div>
{% endblock %}
