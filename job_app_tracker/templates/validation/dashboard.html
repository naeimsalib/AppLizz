{% extends "base.html" %} {% block title %}Email Validation Dashboard{% endblock
%} {% block content %}
<div class="container mt-4">
  <h1>Email Validation Dashboard</h1>

  <div class="row mb-4">
    <div class="col-lg-12">
      <div class="card">
        <div class="card-header">
          <h5>Run Email Validation</h5>
        </div>
        <div class="card-body">
          <form
            action="{{ url_for('validation.run_validation') }}"
            method="POST"
          >
            <div class="row">
              <div class="col-md-3">
                <div class="form-group">
                  <label for="batch_size">Batch Size</label>
                  <input
                    type="number"
                    class="form-control"
                    id="batch_size"
                    name="batch_size"
                    value="100"
                    min="10"
                    max="1000"
                  />
                  <small class="form-text text-muted"
                    >Number of emails to process in a batch</small
                  >
                </div>
              </div>
              <div class="col-md-3">
                <div class="form-group">
                  <label for="max_emails">Max Emails</label>
                  <input
                    type="number"
                    class="form-control"
                    id="max_emails"
                    name="max_emails"
                    value="1000"
                    min="10"
                    max="10000"
                  />
                  <small class="form-text text-muted"
                    >Maximum number of emails to process</small
                  >
                </div>
              </div>
              <div class="col-md-3">
                <div class="form-check mt-4">
                  <input
                    type="checkbox"
                    class="form-check-input"
                    id="suggest_improvements"
                    name="suggest_improvements"
                    checked
                  />
                  <label class="form-check-label" for="suggest_improvements"
                    >Suggest Improvements</label
                  >
                </div>
              </div>
              <div class="col-md-3">
                <div class="form-check mt-4">
                  <input
                    type="checkbox"
                    class="form-check-input"
                    id="apply_improvements"
                    name="apply_improvements"
                  />
                  <label class="form-check-label" for="apply_improvements"
                    >Apply Improvements</label
                  >
                </div>
              </div>
            </div>
            <button type="submit" class="btn btn-primary mt-3">
              Run Validation
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>

  {% if validation_stats %}
  <div class="row mb-4">
    <div class="col-lg-12">
      <div class="card">
        <div class="card-header">
          <h5>Validation Statistics</h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-3">
              <div class="card text-white bg-primary mb-3">
                <div class="card-header">Last Validation</div>
                <div class="card-body">
                  <h5 class="card-title">
                    {{ validation_stats.last_validation.strftime('%Y-%m-%d
                    %H:%M') }}
                  </h5>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="card text-white bg-info mb-3">
                <div class="card-header">Processed Emails</div>
                <div class="card-body">
                  <h5 class="card-title">
                    {{ validation_stats.processed_emails }}
                  </h5>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="card text-white bg-success mb-3">
                <div class="card-header">Job-Related Emails</div>
                <div class="card-body">
                  <h5 class="card-title">
                    {{ validation_stats.job_related_emails }}
                  </h5>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="card text-white bg-warning mb-3">
                <div class="card-header">Overall Accuracy</div>
                <div class="card-body">
                  <h5 class="card-title">
                    {{ (validation_stats.accuracy.overall * 100)|round(1) }}%
                  </h5>
                </div>
              </div>
            </div>
          </div>

          <h5 class="mt-4">Accuracy Breakdown</h5>
          <div class="row">
            <div class="col-md-3">
              <div class="card mb-3">
                <div class="card-header">Classification</div>
                <div class="card-body">
                  <h5 class="card-title">
                    {{ (validation_stats.accuracy.classification * 100)|round(1)
                    }}%
                  </h5>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="card mb-3">
                <div class="card-header">Status</div>
                <div class="card-body">
                  <h5 class="card-title">
                    {{ (validation_stats.accuracy.status * 100)|round(1) }}%
                  </h5>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="card mb-3">
                <div class="card-header">Company</div>
                <div class="card-body">
                  <h5 class="card-title">
                    {{ (validation_stats.accuracy.company * 100)|round(1) }}%
                  </h5>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="card mb-3">
                <div class="card-header">Position</div>
                <div class="card-body">
                  <h5 class="card-title">
                    {{ (validation_stats.accuracy.position * 100)|round(1) }}%
                  </h5>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  {% else %}
  <div class="alert alert-info">
    No validation statistics available. Run a validation to get started.
  </div>
  {% endif %} {% if summary_files %}
  <div class="row mb-4">
    <div class="col-lg-12">
      <div class="card">
        <div class="card-header">
          <h5>Validation Summary Files</h5>
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>File</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                {% for summary in summary_files %}
                <tr>
                  <td>{{ summary.date|datetime }}</td>
                  <td>{{ summary.name }}</td>
                  <td>
                    <a
                      href="{{ url_for('validation.view_summary', summary_file=summary.name) }}"
                      class="btn btn-sm btn-primary"
                      >View</a
                    >
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
  {% endif %} {% if validation_logs %}
  <div class="row mb-4">
    <div class="col-lg-12">
      <div class="card">
        <div class="card-header">
          <h5>Validation Logs</h5>
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>Log File</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                {% for log in validation_logs %}
                <tr>
                  <td>{{ log }}</td>
                  <td>
                    <a
                      href="{{ url_for('validation.view_log', log_file=log) }}"
                      class="btn btn-sm btn-primary"
                      >View</a
                    >
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
  {% endif %}
</div>
{% endblock %}
